<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <!-- import CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="stylesheet" href="./css/operateStyle.css"/>
    <!-- import Vue before Element -->
    <script src="./js/jquery.js"></script>
    <script src="./js/vue.js"></script>
    <!-- import JavaScript -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://cdn.staticfile.org/axios/0.18.0/axios.min.js"></script>
    <title>首页</title>
</head>
<body>
<!--<div id="main" style="width: 600px;height:400px;"></div>-->
<div id="app">
    <el-menu :default-active="activeIndex" class="el-menu-demo" mode="horizontal" @select="handleSelect">
        <el-menu-item index="1">首页</el-menu-item>
        <el-menu-item index="2">任务中心</el-menu-item>
        <el-menu-item index="3">人员中心</el-menu-item>
        <el-submenu index="4">
            <template slot="title">字典管理</template>
            <el-menu-item index="4-1">任务类别</el-menu-item>
            <el-menu-item index="4-2">任务地址</el-menu-item>
        </el-submenu>
    </el-menu>
    <template>
        <el-table :data="taskData" style="width: 100%" v-if="flag == 2">
            <el-table-column prop="startUsername" label="发布人账号"></el-table-column>
            <el-table-column prop="startName" label="发布人昵称"></el-table-column>
            <el-table-column prop="taskTitle" label="任务标题"></el-table-column>
            <el-table-column prop="taskTime" label="发布时间"></el-table-column>
            <el-table-column prop="endUsername" label="接收人账号"></el-table-column>
            <el-table-column prop="endName" label="接收人昵称"></el-table-column>
            <el-table-column fixed="right" label="操作" width="100">
                <template slot-scope="scope">
                    <span class="el-icon-view lookStyle">查看详情</span>
                    <span class="el-icon-delete-solid deleteStyle">删除</span>
                </template>
            </el-table-column>
        </el-table>
    </template>
    <template>
        <el-table :data="userData" style="width: 100%" v-if="flag == 3">
            <el-table-column prop="loginId" label="用户账号"></el-table-column>
            <el-table-column prop="userGender" label="性别" :formatter="formatterGender"></el-table-column>
            <el-table-column prop="phone" label="电话号码"></el-table-column>
            <el-table-column prop="qqNumber" label="QQ号码"></el-table-column>
            <el-table-column prop="wechatNumber" label="微信号码"></el-table-column>
            <el-table-column prop="addTime" label="修改时间"></el-table-column>
            <el-table-column fixed="right" label="操作" width="100">
                <template slot-scope="scope">
                    <span class="el-icon-delete-solid deleteStyle">删除</span>
                </template>
            </el-table-column>
        </el-table>
    </template>
</div>
</body>
<!--<script src="./js/echarts.min.js"></script>-->
<script src="./js/index.js"></script>
<script>
    var vue1 = new Vue({
        el: '#app',
        data: function () {
            return {
                contextPath:'',
                flag: '1',
                urls:{
                    initNews: '/news/selectAllNews',
                    initTask: '/taskInfo/selectAllTask',
                    initUser: '/userInfo/selectAllUser',
                },
                activeIndex: '1',
                activeIndex2: '1',
                taskData:[],
                userData:[],
            }
        },
        created: function () {
            var contextPath = document.location.pathname;
            var contextPath = contextPath.split('/')[1];
            var contextPath = "/" + contextPath;
            this.contextPath = contextPath;
            this.initTask();
            this.initUser();
        },
        filters: {},
        mounted: function () {
        },
        methods: {
            initTask(){
                var self = this;
                var url = self.contextPath + self.urls.initTask;
                axios.get(url)
                    .then(function (res) {
                        console.log(res.data);
                        self.taskData = res.data;
                    })
            },
            initUser(){
                var self = this;
                var url = self.contextPath + self.urls.initUser;
                axios.get(url)
                    .then(function (res) {
                        console.log(res.data);
                        self.userData = res.data;
                    })
            },
            formatterGender(row){
                if (row.userGender === '1'){
                    return "男";
                }
                return "女";
            },
            handleSelect(key, keyPath) {
                this.flag = key;
            }
        },
        watch: {}
    });
</script>
</html>